"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8885],{16700:(e,t,s)=>{s.d(t,{m:()=>o});var a=s(54568),n=s(29242),l=s(27261),i=s.n(l),r=s(62971);function o(e){let{children:t}=e;return(0,a.jsx)(n.m,{tooltipContent:(0,a.jsxs)("div",{className:"max-w-48 p-1",children:[(0,a.jsx)("p",{className:"mb-2 whitespace-break-spaces text-xs tracking-tight",children:(0,a.jsx)(r.A,{defaultMessage:"This is an example project. Create a new project to work with your own documents.",id:"aod9/juMdU"})}),(0,a.jsx)(i(),{href:"/projects/create",className:"text-accent-secondary-200 text-xs tracking-tight",children:(0,a.jsx)(r.A,{defaultMessage:"Create new project",id:"a7FtAnfVfj"})})]}),children:t})}},21869:(e,t,s)=>{s.d(t,{g:()=>i});var a=s(54568),n=s(41417);s(7620);var l=s(62971);let i=e=>{let{isLoading:t,numSelected:s,totalNumItems:i,handleSelectAll:r,handleCancel:o,handleDeleteSelected:d}=e;return(0,a.jsxs)(a.Fragment,{children:[s<i&&(0,a.jsx)(n.$,{variant:"underline",className:"text-sm rounded-md text-accent-secondary-000 mr-2 !opacity-100 h-8",size:"unset",onClick:r,children:(0,a.jsx)(l.A,{defaultMessage:"Select all",id:"94Fg25VD0N"})}),(0,a.jsx)(n.$,{size:"sm",variant:"secondary",onClick:o,children:(0,a.jsx)(l.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(n.$,{size:"sm",variant:"danger",disabled:0===s,onClick:d,loading:t,children:(0,a.jsx)(l.A,{defaultMessage:"Delete <hidden>{space}Selected</hidden>",id:"QE60Po3yK8",values:{space:(0,a.jsx)(a.Fragment,{children:"\xa0"}),hidden:e=>(0,a.jsxs)("span",{className:"max-sm:hidden",children:[" ",e]})}})})]})}},29722:(e,t,s)=>{s.d(t,{b:()=>z});var a=s(54568),n=s(7620),l=s(7386),i=s(51121),r=s(41417),o=s(1385),d=s(77101),c=s(26505),u=s(38452),x=s(49645),m=s(37463),g=s(62971),p=s(41932),h=s(52909),f=s(23661);let j=e=>{let{doc:t,canEditKnowledgeBase:s,compressButton:i,...r}=e,{mutate:o}=(0,p.gG)(t.project_uuid),d=(0,n.useMemo)(()=>new TextEncoder().encode(t.content).length,[t]),c={created_at:t.created_at,file_name:t.file_name,file_size:d,file_type:"",extracted_content:t.content,origin:f.R.UserUpload};return(0,a.jsx)(l.NM,{...r,file:c,handleRemove:()=>o({docUuid:t.uuid})})},v=e=>{let{file:t,projectUuid:s,canEditKnowledgeBase:n,...i}=e,{mutate:r,isPending:o}=(0,p.KU)(s);return(0,a.jsx)(l.NM,{...i,file:t,handleRemove:()=>{r({file_uuids:[t.file_uuid]})},isLoading:o})};var y=s(74211),b=s(50498),w=s(21869),N=s(29242),S=s(11134),M=s(4705),A=s(46760),_=s(91768),k=s(74744);function C(e){let{projectUuid:t,syncSource:s,isActionsHidden:l,canEditKnowledgeBase:r,...o}=e,{mutateAsync:c}=(0,h.bG)(t),{isUpdating:u,handleUpdate:x,isFailing:m}=function(e){let{projectUuid:t,syncSource:s}=e,[a,l]=(0,n.useState)(!1),{addSuccess:r}=(0,i.Y)(),o=(0,A.A)(),{mutate:d}=(0,h.M3)(t,{onSuccess:()=>{r(o.formatMessage({defaultMessage:"Sync started",id:"yyuAtTi0E+"}))}});(0,n.useEffect)(()=>{l(!1)},[s.status]);let c=(0,_.z3)(s)||a,u=(0,_.Dd)(s),x=(0,n.useCallback)(()=>{c||(l(!0),d({sync_source_uuid:s.uuid,sync_source_config:s.config}))},[c,d,s.config,s.uuid]);return{isUpdating:c,isFailing:u,handleUpdate:x}}({projectUuid:t,syncSource:s});return(0,a.jsx)(k.br,{...o,location:"project",projectUuid:t,syncSource:s,handleRemove:()=>c(s.uuid),actions:s.type===d.v8.GITHUB?(0,a.jsx)(U,{handleUpdate:x,isFailing:m,isSyncing:u}):void 0,isSyncing:u||m})}function U(e){let{handleUpdate:t,isFailing:s,isSyncing:n}=e,i=(0,A.A)();return(0,a.jsx)(N.m,{tooltipContent:n?i.formatMessage({defaultMessage:"Syncing...",id:"S92mvo6R0o"}):s?i.formatMessage({defaultMessage:"Sync failed. Click to retry",id:"zOAqlyzs1U"}):i.formatMessage({defaultMessage:"Sync now",id:"SwsYB/OerA"}),children:(0,a.jsx)(l.G,{className:"!w-[18px] !px-0 shrink-0",onClick:t,children:n?(0,a.jsx)(S.P,{size:12,className:"animate-spin"}):s?(0,a.jsx)(M.N,{size:12}):(0,a.jsx)(S.P,{size:12})})})}s(85330);let D=" - compressed",P=e=>'Compress this document into only the most important content and facts. Remove superfluous information and details.\n<knowledge_document file_name="'.concat(e.file_name,'">\n').concat(e.content,"\n</knowledge_document>\nReturn only the summary without any preamble or enclosing tags.");var E=s(59401);let O="project_syncs",I="project_docs",T="project_linked_files";function z(e){let{project:t,canEditKnowledgeBase:s=!1,isUploadingDoc:i=!1,isUploadingDriveSync:d=!1,isUploadingOutlineSync:u=!1,isUploadingGithubSync:p=!1,setIsUploadingDoc:h,setIsUploadingDriveSync:f,setIsUploadingOutlineSync:b,setIsUploadingGithubSync:N,maxItems:S,onViewAll:M,isEditable:A}=e,{githubSyncSources:_,driveSyncSources:k,outlineSyncSources:U,projectDocs:D,linkedFiles:P,isFetchingKnowledge:z,knowledgeCount:K}=F({projectUuid:t.uuid,maxItems:S}),{isDeleting:V,selectedItems:q,handleSelect:B,selectAllItems:J,isInSelectionMode:Y,toggleSelectMode:H,handleDeleteSelected:W}=R({githubSyncSources:_,driveSyncSources:k,outlineSyncSources:U,projectDocs:D,linkedFiles:P,projectUuid:t.uuid,isEnabled:s});G({clearUploadingState:()=>null==h?void 0:h(!1),numItems:D.length+P.length}),G({clearUploadingState:()=>null==N?void 0:N(!1),numItems:_.length}),G({clearUploadingState:()=>null==f?void 0:f(!1),numItems:k.length}),G({clearUploadingState:()=>null==b?void 0:b(!1),numItems:U.length});let Q=new Set(q.map(e=>{let{uuid:t}=e;return t})),$=(0,y.G)();if(z)return(0,a.jsx)(o.j,{height:65,className:"opacity-25 rounded-lg mb-3 mt-3"});if(0===K&&!i&&!d&&!u&&!p)return(0,a.jsx)(L,{canEditKnowledgeBase:s,projectStrings:$});let X=(0,a.jsx)(x.N,{children:Y&&(0,a.jsx)(m.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"ml-auto",children:(0,a.jsx)("div",{className:"flex mt-3 gap-2 justify-end",children:(0,a.jsx)(w.g,{isLoading:V,numSelected:q.length,totalNumItems:K,handleSelectAll:J,handleCancel:()=>H(!1),handleDeleteSelected:W})})},"item-management-menu")}),Z={size:"stretch",isEditable:A,isInSelectionMode:Y};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.N,{children:s&&(0,a.jsx)(m.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},children:(0,a.jsx)(E.H,{projectUuid:t.uuid})})}),(0,a.jsx)("ul",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-3",children:(0,a.jsxs)(x.N,{initial:!1,children:[(0,a.jsx)(l.NG,{isShown:d,...Z}),k.map(e=>(0,a.jsx)(C,{projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:Y||!s,...Z,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:O},t,s)},e.uuid)),(0,a.jsx)(l.NG,{isShown:u,...Z},"outline-sync-loading-indicator"),U.map(e=>(0,a.jsx)(C,{projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:Y||!s,...Z,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:O},t,s)},e.uuid)),(0,a.jsx)(l.NG,{isShown:p,...Z},"github-sync-loading-indicator"),_.map(e=>(0,n.createElement)(C,{...Z,key:e.uuid,projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:Y||!s,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:O},t,s)})),(0,a.jsx)(l.NG,{isShown:i,...Z},"doc-upload-loading-indicator"),D.map(e=>(0,n.createElement)(j,{...Z,key:e.uuid,doc:e,canEditKnowledgeBase:s,compressButton:void 0,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:I},t,s)})),P.map(e=>(0,n.createElement)(v,{...Z,key:e.file_uuid,file:e,projectUuid:t.uuid,canEditKnowledgeBase:s,handleSelect:(t,s)=>B({uuid:e.file_uuid,type:T},t,s),isSelected:Q.has(e.file_uuid)}))]})}),X,!!M&&!!S&&K>S&&(0,a.jsx)("div",{children:(0,a.jsxs)(r.$,{variant:"unstyled",onClick:M,className:"hover:text-text-000 hover:underline !px-0 text-sm",children:[(0,a.jsx)(g.A,{defaultMessage:"View all {count} files",id:"b36mSZ46cW",values:{count:K}}),(0,a.jsx)(c.Q,{size:16,className:"inline-block pl-1"})]})})]})}let G=e=>{let{clearUploadingState:t,numItems:s}=e,a=(0,n.useRef)(s);(0,n.useEffect)(()=>{s>a.current&&t(),a.current=s},[s,t])},F=e=>{let{projectUuid:t,maxItems:s}=e,{data:a=[],isLoading:n}=(0,p.MO)(t),l=[...a],{data:i=[],isLoading:r}=(0,h.CO)(t),{data:o=[],isLoading:c}=(0,p.uE)(t),u=[...o],x=i.filter(e=>{let{type:t}=e;return t===d.v8.GDRIVE}),m=i.filter(e=>{let{type:t}=e;return t===d.v8.OUTLINE}),g=i.filter(e=>{let{type:t}=e;return t===d.v8.GITHUB});if(s){let e=s;[x,m,g,l,u].forEach(t=>{t.splice(e),e=Math.max(0,e-t.length)})}let f=[l,i,u].reduce((e,t)=>{var s;return e+(null!=(s=null==t?void 0:t.length)?s:0)},0);return{driveSyncSources:x,outlineSyncSources:m,githubSyncSources:g,projectDocs:l,linkedFiles:u,isFetchingKnowledge:n||r||c,knowledgeCount:f}},R=e=>{let{githubSyncSources:t,driveSyncSources:s,outlineSyncSources:a,projectDocs:n,linkedFiles:l,projectUuid:r,isEnabled:o}=e,d=s.map(e=>{let{uuid:t}=e;return{type:O,uuid:t}}).concat(t.map(e=>{let{uuid:t}=e;return{type:O,uuid:t}})).concat(a.map(e=>{let{uuid:t}=e;return{type:O,uuid:t}})).concat(n.map(e=>{let{uuid:t}=e;return{type:I,uuid:t}})).concat(l.map(e=>{let{file_uuid:t}=e;return{type:T,uuid:t}})),{selectedItems:c,handleSelect:u,selectAllItems:x,isInSelectionMode:m,toggleSelectMode:g}=(0,b.m)(d,!o),{addError:f}=(0,i.Y)(),{mutateAsync:j,isPending:v}=(0,h.z_)(r),{mutateAsync:y,isPending:w}=(0,p.Aw)(r),{mutateAsync:N,isPending:S}=(0,p.KU)(r),M=async()=>{let e=c.filter(e=>{let{type:t}=e;return t===I}),t=c.filter(e=>{let{type:t}=e;return t===O}),s=c.filter(e=>{let{type:t}=e;return t===T});g(!1);try{await Promise.all([e.length?y({doc_uuids:e.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve(),t.length?j({sync_source_uuids:t.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve(),s.length?N({file_uuids:s.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve()])}catch(e){f("Something went wrong while deleting. Refresh the page and try again")}};return{isDeleting:w||v||S,selectedItems:c,handleSelect:u,selectAllItems:x,isInSelectionMode:m,toggleSelectMode:g,handleDeleteSelected:M}},L=e=>{var t,s;let{canEditKnowledgeBase:n,projectStrings:l}=e;return(0,a.jsxs)("div",{className:"bg-bg-500/10 text-text-400 mb-1 mt-2 flex w-full flex-col items-center gap-3 rounded-lg px-6 pb-10 pt-8 text-center text-sm",children:[(0,a.jsx)(u.t,{size:36,weight:"thin"}),n?null!=(t=null==l?void 0:l.projectNoKnowledgeCanAddMessage)?t:(0,a.jsx)(g.A,{defaultMessage:"No knowledge added yet. Add PDFs, documents, or other text to the project knowledge base that Claude will reference in every project conversation.",id:"j7/C6AKAfW"}):null!=(s=null==l?void 0:l.projectNoKnowledgeCantAddMessage)?s:(0,a.jsx)(g.A,{defaultMessage:"No knowledge added yet.",id:"frsVQgI4+c"})]})}},50498:(e,t,s)=>{s.d(t,{m:()=>n});var a=s(7620);let n=(e,t)=>{let[s,n]=(0,a.useState)(!1),[l,i]=(0,a.useState)([]),r=(s,a)=>{t||i(t=>{if(!a||0===Object.keys(t).length)return[...t,s];let n=t[Object.keys(t).length-1],l=e.findIndex(e=>{let{uuid:t,type:s}=e;return t===n.uuid&&s===n.type});if(-1===l)return[...t,s];let i=e.findIndex(e=>{let{uuid:t}=e;return t===s.uuid}),r=Math.min(l+1,i),o=Math.max(l-1,i),d=e.slice(r,o+1),c=t.map(e=>{let{uuid:t}=e;return t});return[...t,...d.filter(e=>{let{uuid:t}=e;return -1===c.indexOf(t)})]})},o=e=>{t||i(t=>t.filter(t=>{let{uuid:s,type:a}=t;return s!==e.uuid||a!==e.type}))};return(0,a.useEffect)(()=>{let t=l.filter(t=>e.some(e=>e.uuid===t.uuid&&e.type===t.type));t.length!==l.length&&i(t)},[e]),(0,a.useEffect)(()=>{n(l.length>0)},[l]),{selectedItems:l,handleSelect:(e,s,a)=>{t||(s?r(e,a):o(e))},selectAllItems:()=>{t||i(e)},isInSelectionMode:!t&&s,toggleSelectMode:e=>{n(e),e||i([])}}}},59401:(e,t,s)=>{s.d(t,{H:()=>eo,w:()=>es});var a=s(54568),n=s(66860),l=s(61125),i=s(1761),r=s(51121),o=s(9537),d=s(34059),c=s(41417),u=s(56370),x=s(37076),m=s(29242),g=s(89674),p=s(71473),h=s(27062),f=s(77101),j=s(99778),v=s(24871),y=s(62094),b=s(63817),w=s(64039),N=s(87606),S=s(32987),M=s(7620),A=s(46760),_=s(62971),k=s(41932),C=s(81527),U=s(85717),D=s(71436),P=s(45715),E=s(56147),O=s(16700),I=s(87907),T=s(56566),z=s(8816),G=s(13261),F=s(16430),R=s(67455),L=s(52909),K=s(15046),V=s(45078);function q(e){let{conversation:t}=e,s=(0,U.K6)(),n=(0,U.$f)(t),{toggleConversationSetting:l}=(0,V.rX)();return s?(0,a.jsx)("div",{className:"px-2 py-1.5 -mx-1 -mb-1 border-t-0.5 border-border-300 hover:bg-bg-200",children:(0,a.jsxs)(u.tJ,{className:"flex flex-row gap-4 cursor-pointer px-2 pt-1 pb-2",onSelect:e=>{e.stopPropagation(),e.preventDefault(),l("enabled_bananagrams",!n)},onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{children:(0,a.jsx)(_.A,{defaultMessage:"Allow Claude to search",id:"zyxxt7OHPv"})}),(0,a.jsx)("p",{className:"text-xs text-text-400",children:(0,a.jsx)(_.A,{defaultMessage:"Claude will search for relevant documents",id:"JxbYvAvtdV"})})]}),(0,a.jsx)(K.j,{checked:n,readOnly:!0})]})}):null}var B=s(35391),J=s(1385);function Y(e){let{title:t,url:s,isLoading:n,isError:l,isLink:i=!1,defaultErrorTitle:r,defaultDocumentTitle:o}=e,d=(0,a.jsx)("p",{children:o});return(l?d=(0,a.jsx)("p",{children:r}):!n||t||o?t&&(d=(0,a.jsx)("p",{children:t})):d=(0,a.jsx)(J.j,{className:"opacity-25 rounded-md",height:18}),i&&s)?(0,a.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:d}):d}function H(e){let{uri:t,isError:s,isLink:n=!1}=e,{data:l,isLoading:i}=(0,U.y)({documentId:t}),r=(0,B.d)(t);return(0,a.jsx)(Y,{title:null==l?void 0:l.title,url:r,isLoading:i,isError:s,isLink:n,defaultErrorTitle:"Google Docs"})}var W=s(48676),Q=s(31102);let $={includeScore:!0,threshold:.3,keys:["title"],ignoreLocation:!0},X=e=>{let{conversation:t,projectUuid:s,trigger:n,align:l,isSubDropdown:i=!1,setIsUploadingDriveSync:d,onCreated:c,isOpen:x,setIsOpen:m,closeWholeDropdown:p=()=>m(!1),shouldAddSyncUponPaste:j}=e,v=(0,A.A)(),{value:y}=(0,h.fS)("kingfisher_prefetch"),{recentDriveDocs:b,isLoading:w}=(0,U.zH)(y||x),[N,S]=(0,M.useState)(""),[_,k]=(0,M.useState)(!1),[C,D]=(0,M.useState)(""),{addError:P}=(0,r.Y)(),E=(0,M.useRef)(null),O=(0,M.useRef)(null),I=()=>{d(!0),k(!0)},T=e=>{null==c||c(e),p(),k(!1)},z=e=>{d(!1),k(!1),P((0,Q.J)(e))},{mutate:G}=(0,R.EF)({onMutate:I,onSuccess:T,onError:z,meta:{noToast:!0}}),{mutate:K}=(0,L.pz)(s,{onMutate:I,onSuccess:T,onError:z,meta:{noToast:!0}}),V=(0,M.useMemo)(()=>b&&N?new F.A(b,$).search(N).map(e=>e.item):b,[b,N]),B=N?null==V?void 0:V.slice(0,7):null==b?void 0:b.slice(0,5),J=e=>{p(),(s?K:G)({sync_source_type:f.v8.GDRIVE,sync_source_config:{uri:e}})},Y=e=>{let t=(0,W.$)(e);S(e);let s="";if(t)J(t);else if((0,W.X)(e))s=v.formatMessage({defaultMessage:"Only Google Docs are supported at this time",id:"P3m20xflVA"});else try{new URL(e),s=v.formatMessage({defaultMessage:"Not a valid Google Doc URL",id:"S//j6oF0j8"})}catch(e){}D(s)};(0,g.y)({target:E,shouldFocus:x}),(0,M.useEffect)(()=>{x||(S(""),k(!1),D(""))},[x,S,k,D]);let H=!!s,X=i?u.FV:u.ms;return(0,a.jsxs)(X,{className:"text-md w-[332px] p-0 overflow-hidden",align:l,trigger:n,onKeyDown:e=>{if(!["Enter","ArrowDown","ArrowUp"].includes(e.key)){var t;null==(t=E.current)||t.focus()}},onFocusOutside:e=>e.preventDefault(),...i?{forceMount:!0}:{open:x,onOpenChange:m,unstyledTrigger:!0},children:[(0,a.jsx)(u.Bi,{children:(0,a.jsx)(o.ks,{ref:E,value:N,placeholder:v.formatMessage({defaultMessage:"Search recents or paste URL",id:"jprBObbn5b"}),className:"w-full bg-inherit border-none select-none",onChange:e=>{Y(e.target.value)},onPasteCapture:e=>{if(e.stopPropagation(),!x)return;let t=e.clipboardData.getData("text"),s=(0,W.$)(t);s&&j&&J(s)},onKeyDown:e=>{if("ArrowLeft"===e.key&&N)e.stopPropagation();else if("Enter"===e.key)Y(e.currentTarget.value);else if("ArrowDown"===e.key&&B&&B.length>0){var t;e.preventDefault(),null==(t=O.current)||t.focus()}},"data-1p-ignore":!0,autoComplete:"off",autoFocus:!0})}),(0,a.jsx)(Z,{inputRef:E,firstDocumentRef:O,handleAddDocument:J,documents:B,isValidatingUrl:_,isFetchingRecentDriveDocs:w,errorMessage:C}),!H&&!N&&(0,a.jsx)(q,{conversation:t})]})},Z=e=>{let{inputRef:t,firstDocumentRef:s,handleAddDocument:n,documents:l,isValidatingUrl:i,isFetchingRecentDriveDocs:r,errorMessage:o}=e,c=i||r&&!l.length,x=!!o,m=!c&&(!l||!l.length);return c?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:(0,a.jsx)(z.y,{className:"animate-spin mx-auto"})}):x?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px] text-center",children:[(0,a.jsx)(G.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(_.A,{defaultMessage:"Invalid URL",id:"SASA4f9KO3"})}),(0,a.jsx)("p",{className:"text-sm text-danger-000",children:o})]}):m?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:[(0,a.jsx)(G.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(_.A,{defaultMessage:"No recents found",id:"2FzJykASLO"})}),(0,a.jsx)("p",{className:"text-sm text-text-500",children:(0,a.jsx)(_.A,{defaultMessage:"Try pasting the URL instead",id:"jf3/+bX0lc"})})]}):(0,a.jsx)("div",{className:"px-1.5 py-1",children:l.map((e,l)=>{let{uri:i,title:r}=e;return(0,a.jsxs)(u.tJ,{className:"!grid-cols-[max-content_auto] hover:text-text-000 hover:bg-bg-200",ref:0===l?s:void 0,onClick:()=>n(i),onKeyDown:e=>{if("ArrowUp"===e.key&&0===l){var s;e.preventDefault(),null==(s=t.current)||s.focus()}},textValue:"",onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsx)(d.A9,{type:f.v8.GDRIVE,variant:d.UF.DOCS,size:16}),(0,a.jsx)("span",{className:"truncate",children:null!=r?r:(0,a.jsx)(H,{uri:i})})]},i)})})},ee=/^https:\/\/outline\.staging\.ant\.dev\/doc\/[a-zA-Z0-9]+/;function et(e){let{documentId:t,url:s,onRemoveFile:a}=e;assertAntOnly("outline");let{data:n,isLoading:l,isError:i}=useOutlineDocument({documentId:t});if(l)return _jsx(SkeletonLoader,{height:65,className:"opacity-25 rounded-lg mb-3 mt-1"});let r=i?_jsx(FormattedMessage,{defaultMessage:"Outline document",id:"tJq+ydtn3V"}):(null==n?void 0:n.title)||_jsx(FormattedMessage,{defaultMessage:"Untitled",id:"3kbIhS7KZS"}),o=i?_jsx(FormattedMessage,{defaultMessage:"You do not have access to this document",id:"ZW4SPjavWl"}):(null==n?void 0:n.created_by)||_jsx(FormattedMessage,{defaultMessage:"Unknown",id:"5jeq8PJZg7"});return _jsx("a",{className:"",href:s,target:"blank",children:_jsxs("div",{className:"flex bg-gradient-to-t from-bg-100 to-bg-000/75 border-0.5 border-border-300 mb-3 mt-1 rounded-xl shadow-sm items-center",children:[_jsxs("div",{className:"group p-2 gap-3 flex items-center flex-grow",children:[_jsx("div",{className:"relative shrink-0 ".concat(i?"bg-danger-900/20":"bg-accent-secondary-900/75"," py-3 px-3 border-0.5 border-border-300 rounded-lg group-hover:shadow-sm transition group-hover:bg-").concat(i?"danger-900/15":"accent-secondary-900/50"),children:_jsx(SyncSourceLogo,{type:SyncSourceType.OUTLINE,size:24,isError:i})}),_jsxs("div",{className:"flex flex-col",children:[_jsx("div",{className:"leading-5",children:r}),_jsxs("div",{className:"relative min-w-72 h-4",children:[_jsx("div",{className:"absolute inset-0 text-xs ".concat(i?"text-danger-000":"text-text-500"," group-hover:opacity-0 group-hover:translate-x-1 translate-x-0 opacity-100 transition"),children:o}),_jsxs("div",{className:"absolute inset-0 text-xs ".concat(i?"text-danger-000":"text-text-300"," group-hover:inline-block group-hover:opacity-100 opacity-0 -translate-x-1 group-hover:translate-x-0 transition"),children:[i?_jsx(FormattedMessage,{defaultMessage:"Request access in outline",id:"MkwQJKpXRk"}):_jsx(FormattedMessage,{defaultMessage:"Open in <emphasis>Outline</emphasis>",id:"GloEndXa0h",values:{emphasis:e=>_jsx("span",{className:"text-text-100",children:e})}}),_jsx(ArrowUpRight,{className:"inline-block group-hover:scale-100 scale-75 transition-all duration-300 ml-1"})]})]})]})]}),_jsx(Tooltip,{tooltipContent:_jsx(FormattedMessage,{defaultMessage:"Remove",id:"G/yZLul6P1"}),children:_jsx(Button,{onClick:e=>{e.preventDefault(),null==a||a()},className:"ml-auto mr-2",variant:"ghost",size:"icon_sm",children:_jsx(Trash,{})})})]})})}let es=e=>{let{projectUuid:t,isStarterProject:s,isUploading:o,setIsUploadingDoc:d,setIsUploadingGithubSync:c,setIsUploadingDriveSync:u,setIsUploadingOutlineSync:x}=e,{activeOrganization:m}=(0,i.YL)(),g=null==m?void 0:m.uuid,f=(0,A.A)(),j=(0,M.useRef)(null),[v,y]=(0,M.useState)(""),[b,w]=(0,M.useState)(""),[S,O]=(0,M.useState)(!1),[I,z]=(0,M.useState)(!1),[G,F]=(0,M.useState)(!1),{addError:R}=(0,r.Y)(),{mutateAsync:L}=(0,k.fh)(t,{onError:()=>d(!1)}),{data:K}=(0,C.fo)(t),{checkIsGithubAuthenticated:V,initGithubAuth:q}=(0,D.nB)({callerIdentifier:"project",toggleGithubModalOpen:z}),B=(0,D.Cq)(),{isOutlineAuthenticated:J}=(0,P.I5)(),Y=(0,P.AI)(),H=(0,U.LP)(),W=(0,E.ED)(t),{maxKbTokens:Q}=(0,E.AO)(),$=(null!=W?W:0)>Q,X=(0,N.useQueryClient)(),Z=(0,M.useCallback)(async(e,s)=>{for(let t of e)await L({file_name:t.file_name,content:t.extracted_content});s.length&&X.invalidateQueries({queryKey:[p.mw,{orgUuid:g,projectUuid:t}]})},[L,g,t,X]),ee=(0,l.cV)(),et=(0,n.i1)(),{value:es}=(0,h.fS)("project_janus"),{value:en}=(0,h.fS)("project_image"),{handleUpload:el}=(0,n.vV)({imagesEnabled:en,blobFileUploadsEnabled:ee,rasterizePdfUploadsEnabled:et&&es,onUploadComplete:async function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];await Z(...t)},onError:()=>{d(!1)},projectUuid:t}),ei=(0,M.useCallback)(async e=>{let t=e.target.files;t&&(d(!0),await el(Array.from(t),Q-(null!=W?W:0)),d(!1)),e.target.value=""},[el,d,W,Q]),eo=async()=>{try{O(!1),d(!0),await L({file_name:b,content:v}),w(""),y("")}catch(e){d(!1),R(f.formatMessage({defaultMessage:"Error saving text content",id:"9U64gLEIVo"}))}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{"data-testid":"project-doc-upload",ref:j,type:"file",className:"hidden",accept:(0,l.cm)({imagesEnabled:en,outOfContextFilesEnabled:ee}).join(","),onChange:ei,multiple:!0}),(0,a.jsx)(ea,{projectUuid:t,shouldShowGithubSyncSource:B,shouldShowDriveSyncSource:H,shouldShowOutlineSyncSource:Y,handleGithubClick:()=>{V().then(e=>{if(e)return void z(!0);q()})},handleOutlineClick:()=>{J?F(!0):R((0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("div",{children:(0,a.jsx)(_.A,{defaultMessage:"You need to connect to Outline before using this feature.",id:"PejG+e4wN5"})}),(0,a.jsx)("button",{onClick:()=>{window.location.href="/settings/profile"},className:"mt-2 underline",children:(0,a.jsx)(_.A,{defaultMessage:"Connect to Outline",id:"m1DuTWXorQ"})})]}))},handleFileUploadClick:()=>{j.current&&j.current.click()},handleTextContentClick:()=>O(!0),isPrivateProject:!!(null==K?void 0:K.is_private),isStarterProject:s,isOverProjectKnowledgeLimit:$,isLoading:o,setIsUploadingDriveSync:u}),(0,a.jsx)(er,{isOpen:S,onClose:()=>O(!1),title:b,setTitle:w,content:v,setContent:y,onSave:eo}),B&&(0,a.jsx)(T.s,{location:"project",isOpen:I,onClose:()=>z(!1),projectUuid:t,setIsUploadingGithubSync:c}),Y&&""]})},ea=e=>{let{projectUuid:t,shouldShowGithubSyncSource:s,shouldShowDriveSyncSource:n,handleGithubClick:l,handleFileUploadClick:i,handleTextContentClick:r,isPrivateProject:o,isStarterProject:d,isOverProjectKnowledgeLimit:c,isLoading:x,shouldShowOutlineSyncSource:m,handleOutlineClick:g,setIsUploadingDriveSync:p}=e,[h,v]=(0,M.useState)(!1),[y,w]=(0,M.useState)(!1),N=n||s,{isDriveAuthenticated:S,initDriveAuth:A,handleDriveTrigger:k}=(0,U.cI)({callerIdentifier:"project",handleAuthSuccess:e=>{v(e),e?setTimeout(()=>{w(e)},100):w(e)}}),C=S&&o;return(0,a.jsxs)(u.ms,{align:"end",unstyledTrigger:!0,trigger:(0,a.jsx)(en,{isStarterProject:d,isOverProjectKnowledgeLimit:c,isLoading:x}),open:h,onOpenChange:v,children:[(0,a.jsx)(u.tJ,{onClick:i,className:"text-left",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.x,{size:16}),(0,a.jsx)(_.A,{defaultMessage:"Upload from device",id:"vMaZk5Jcnv"})]})}),(0,a.jsx)(u.tJ,{onClick:r,className:"text-left",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.v,{size:16}),(0,a.jsx)(_.A,{defaultMessage:"Add text content",id:"G7XW3Mvn8X"})]})}),N?(0,a.jsx)(u.DG,{}):null,s&&(0,a.jsx)(el,{type:f.v8.GITHUB,isPrivateProject:o,onClick:l}),n&&(0,a.jsx)(ei,{projectUuid:t,isPrivateProject:o,setIsUploadingDriveSync:p,isOpen:y,setIsOpen:w,closeWholeDropdown:()=>{w(!1),v(!1)},showGoogleDriveSubDropdown:C,handleGoogleDriveButtonClick:()=>{!C&&o&&(S?k():A())}}),m&&(0,a.jsx)(el,{type:f.v8.OUTLINE,isPrivateProject:o,onClick:g})]})},en=(0,M.forwardRef)((e,t)=>{let{isStarterProject:s,isOverProjectKnowledgeLimit:n,isLoading:l,...i}=e,r=(0,a.jsx)(c.$,{...i,ref:t,className:"bg-inherit border-0.5 hover:bg-bg-300/70 border-border-300 transition rounded-lg  scale-100",size:"icon_sm",variant:"unstyled","data-testid":"project-doc-uploader-dropdown-trigger",disabled:s||n||l,loading:l,children:(0,a.jsx)(v.F,{size:14,weight:"bold"})});return s?(0,a.jsx)(O.m,{children:(0,a.jsx)("div",{children:r})}):n?(0,a.jsx)(m.m,{side:"bottom",tooltipContent:(0,a.jsx)(_.A,{defaultMessage:"Project knowledge at capacity. Remove an existing file in order to add to knowledge",id:"g3hx72ya32"}),children:(0,a.jsx)("div",{children:r})}):(0,a.jsx)(m.m,{side:"bottom",tooltipContent:(0,a.jsx)(_.A,{defaultMessage:"Add content to project",id:"kLVlcps4zm"}),children:r})});en.displayName="ProjectDocUploaderDropdownTrigger";let el=e=>{let{type:t,isPrivateProject:s,isSubTrigger:n=!1,isSubDropdownOpen:l=!1,onClick:i}=e,r=n?u.Wn:u.tJ,o=(0,a.jsxs)(r,{onClick:i,onPointerLeave:e=>{n&&l&&e.preventDefault()},onPointerMove:e=>{n&&l&&e.preventDefault()},disabled:!s,className:"text-left",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A9,{type:t,size:16}),(0,I.xI)(t)]}),n&&(0,a.jsx)(y.K,{size:16})]});return s?o:(0,a.jsx)(m.m,{side:"left",tooltipContent:(0,a.jsx)(_.A,{defaultMessage:"Only accessible from private projects",id:"lNrma+LwGe"}),children:(0,a.jsx)("div",{children:o})})},ei=e=>{let{projectUuid:t,isPrivateProject:s,setIsUploadingDriveSync:n,isOpen:l,setIsOpen:i,closeWholeDropdown:r,showGoogleDriveSubDropdown:o,handleGoogleDriveButtonClick:d}=e;return o?(0,a.jsxs)(u.MS,{open:l,onOpenChange:i,children:[(0,a.jsx)(el,{type:f.v8.GDRIVE,isPrivateProject:s,isSubTrigger:!0,isSubDropdownOpen:l}),(0,a.jsx)(u.cm,{children:(0,a.jsx)(X,{projectUuid:t,isSubDropdown:!0,setIsUploadingDriveSync:n,isOpen:l,setIsOpen:i,closeWholeDropdown:r,shouldAddSyncUponPaste:!0})})]}):(0,a.jsx)(el,{type:f.v8.GDRIVE,isPrivateProject:s,onClick:d})},er=e=>{let{isOpen:t,onClose:s,title:n,setTitle:l,content:i,setContent:r,onSave:d}=e,u=(0,A.A)(),m=(0,M.useRef)(null);return(0,g.y)({shouldFocus:t,target:m}),(0,a.jsx)(x.aF,{isOpen:t,onClose:s,modalSize:"xl",className:"p-7 pt-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),""!==n.trim()&&""!==i.trim()&&d()},children:[(0,a.jsx)("h2",{className:"font-claude-response mb-3 text-xl",children:(0,a.jsx)(_.A,{defaultMessage:"Add text content",id:"G7XW3Mvn8X"})}),(0,a.jsx)(o.ks,{ref:m,placeholder:u.formatMessage({defaultMessage:"Name your content",id:"C7Sx4g/l21"}),className:"mb-2 w-full",size:"lg",label:(0,a.jsx)(_.A,{defaultMessage:"Title",id:"9a9+wwWy4u"}),value:n,onChange:e=>l(e.target.value),required:!0}),(0,a.jsx)(o.fs,{placeholder:u.formatMessage({defaultMessage:"Type or paste in content...",id:"f5RDuqxeT2"}),label:u.formatMessage({defaultMessage:"Content",id:"Jq3FDzj0/T"}),minRows:12,value:i,onChange:e=>r(e.target.value),required:!0,className:"max-h-[50vh] overflow-y-auto"}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,a.jsx)(c.$,{variant:"secondary",onClick:e=>{e.preventDefault(),s()},children:(0,a.jsx)(_.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(c.$,{type:"submit",children:(0,a.jsx)(_.A,{defaultMessage:"Add Content",id:"66s1201qd9"})})]})]})})},eo=e=>{let{size:t="default",projectUuid:s,tooltipContent:n}=e,l=(0,E.ED)(s),{maxKbTokens:i}=(0,E.AO)(),r=(0,E.gq)(s),o=(0,E.AV)(),d=(0,E.Pb)(s);if(!l)return null;let u=Math.ceil(l/i*100),x=u>80&&u<100,g=u>=100,p=r?Math.min(100,r/i*100):void 0;return(0,a.jsxs)("div",{className:(0,S.A)("default"!==t&&"flex items-center gap-3"),children:[(0,a.jsxs)("div",{className:(0,S.A)("bg-bg-300 rounded-full p-px border-border-300 border-0.5 relative","small"===t&&"w-24"),children:[(0,a.jsx)("div",{style:{width:"".concat(Math.max(2,Math.min(100,u)),"%")},className:(0,S.A)("h-1.5 rounded-full transition-all",!x&&!g&&"bg-accent-secondary-100",x&&"bg-warning-orange",g&&"bg-danger-100")}),o&&void 0!==p&&l>=(r||0)&&(0,a.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 w-1.5 h-1.5 bg-text-100 rounded-full mix-blend-normal",style:{left:"".concat(p,"%"),transform:"translate(-50%, -50%)"}})]}),(0,a.jsxs)("div",{className:(0,S.A)("flex gap-2 items-center text-xs","default"===t&&"mt-2"),children:[(0,a.jsx)("div",{className:(0,S.A)("flex-1",u<100&&"text-text-400",u>=100&&"text-danger-000 font-medium"),children:(0,a.jsx)(_.A,{defaultMessage:"{pctUsed}% of project capacity used",id:"JfriU6oVgp",values:{pctUsed:u}})}),!o&&(0,a.jsx)(m.m,{className:"text-center mt-0.5",side:"left",tooltipContent:null!=n?n:(0,a.jsx)(_.A,{defaultMessage:"Project knowledge is currently limited to Claude’s maximum context window size.",id:"aAeavdIV/P"}),children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(c.$,{size:"unset",variant:"unstyled",href:"https://support.anthropic.com/en/articles/9517075-what-are-projects",target:"_blank",className:"rounded-full text-text-500 hover:text-text-200",children:(0,a.jsx)(w.R,{size:14})})})}),d&&(0,a.jsx)("div",{className:"text-text-400 text-xs flex gap-1",children:(0,a.jsx)(m.m,{className:"text-center mt-0.5",side:"bottom",tooltipContent:null!=n?n:(0,a.jsx)(_.A,{defaultMessage:"To save space, Claude looks up information as needed.",id:"a/OO1blv/l"}),children:(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-text-500 rounded-full"}),(0,a.jsx)(_.A,{defaultMessage:"Retrieving",id:"RmdvWf4BuF"})]})})})]}),u>=100&&(0,a.jsx)("div",{className:"text-text-400 text-xs",children:(0,a.jsx)(_.A,{defaultMessage:"Remove an existing file in order to add to knowledge",id:"mSQjDnX2IA"})})]})}},61527:(e,t,s)=>{s.d(t,{k:()=>p});var a=s(54568),n=s(51121),l=s(9537),i=s(41417),r=s(37076),o=s(27062),d=s(27261),c=s.n(d),u=s(7620),x=s(46760),m=s(62971),g=s(81527);function p(e){let{isOpen:t,onClose:s,project:d}=e,p=(0,x.A)(),[h,f]=(0,u.useState)(d.prompt_template),[j,v]=(0,u.useState)(!1),{value:y}=(0,o.fS)("claudeai_custom_styles"),{value:b}=(0,o.fS)("claude_ai_cayenne"),{addError:w}=(0,n.Y)(),{mutateAsync:N}=(0,g.sS)(d.uuid),S=async()=>{v(!0);try{await N({prompt_template:h}),s(),v(!1)}catch(e){w(p.formatMessage({defaultMessage:"Error saving instructions, please try again later",id:"WL3FdCcP2y"})),v(!1)}},M=d.prompt_template.length>0&&0===h.length,A=b?(0,a.jsx)(m.A,{defaultMessage:"This will work alongside <link>user preferences</link> and the selected style in a chat.",values:{link:e=>(0,a.jsx)(c(),{className:"hover:underline",href:"/settings/profile",children:e})},id:"NlixH3av58"}):(0,a.jsx)(m.A,{defaultMessage:"This will work alongside the selected style in a chat.",id:"rptxrPz/Y3"});return(0,a.jsxs)(r.aF,{isOpen:t,onClose:s,modalSize:"xl",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("h2",{className:"font-xl-bold",children:(0,a.jsx)(m.A,{defaultMessage:"Set project instructions",id:"+On7CFwfGv"})}),(0,a.jsxs)("p",{className:"text-text-300 text-sm",children:[(0,a.jsx)(m.A,{defaultMessage:"Provide Claude with relevant instructions and information for chats within {projectName}.",id:"NM6ePuQ0y+",values:{projectName:d.name}}),"\xa0",y&&A]})]}),(0,a.jsx)("div",{className:"mb-6 mt-3",children:(0,a.jsx)(l.fs,{"data-testid":"custom-instructions-textarea",value:h,onChange:e=>f(e.target.value),placeholder:[p.formatMessage({defaultMessage:"Think step by step and show reasoning for complex problems. Use specific examples.",id:"j554E3Ar1K"}),p.formatMessage({defaultMessage:"Break down large tasks and ask clarifying questions when needed.",id:"H/tJ47E9to"}),p.formatMessage({defaultMessage:"Use Artifacts only for web apps and code demos.",id:"U50hIJOW7M"}),p.formatMessage({defaultMessage:"When giving feedback, explain thought process and highlight issues and opportunities.",id:"f2YGj7vTV3"})],minRows:16,required:!0,customScrollbar:!0,className:"max-h-80"})}),(0,a.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,a.jsx)(i.$,{variant:"secondary",onClick:s,children:(0,a.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(i.$,{loading:j,disabled:d.prompt_template===h,onClick:()=>{S()},children:M?(0,a.jsx)(m.A,{defaultMessage:"Clear instructions",id:"aHS9gkqH/s"}):(0,a.jsx)(m.A,{defaultMessage:"Save instructions",id:"wtm6MF4hNg"})})]})]})}},74211:(e,t,s)=>{s.d(t,{G:()=>o,p:()=>r});var a=s(54568),n=s(7620),l=s(15957);let i=(0,n.createContext)(void 0);function r(e){let{project:t,children:s}=e,n=(0,l.X)(t);return(0,a.jsx)(i.Provider,{value:n,children:s})}function o(){return(0,n.useContext)(i)}},85330:(e,t,s)=>{s.d(t,{f:()=>o});var a=s(1761),n=s(51121),l=s(27062),i=s(7620),r=s(46760);let o=function(){let{artifactUuid:e,onRateLimitError:t,onMissingOrganization:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{value:o}=(0,l.fS)("apps_use_turmeric"),{value:d}=(0,l.fS)("claude_ai_turmeric_proxy_enabled"),{activeOrganization:c}=(0,a.YL)(),{addError:u}=(0,n.Y)(),x=(0,r.A)();return(0,i.useCallback)(async a=>{if(!o)return Promise.resolve(null);if(!(null==c?void 0:c.uuid))return null==s||s(),Promise.resolve(null);try{if(d){var n;let s=await fetch("/api/organizations/".concat(null==c?void 0:c.uuid,"/proxy/v1/messages"),{method:"POST",headers:{"Content-Type":"application/json",...e?{"anthropic-artifact-id":e}:{}},body:JSON.stringify({messages:[{role:"user",content:a}]})});if(!s.ok)throw 429===s.status&&(t?t():u(x.formatMessage({defaultMessage:"Limit reached. This artifact uses Claude for responses. Try again when the message limit resets.",id:"5Ocu9uCFLz"}))),Error("HTTP error! status: ".concat(s.status));let l=await s.json();return Promise.resolve((null==(n=l.content[0])?void 0:n.text)||null)}let s=await fetch("/api/artifacts/api/".concat(null==c?void 0:c.uuid,"/completion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:a,artifact_uuid:e})});if(!s.ok)throw 429===s.status&&(t?t():u(x.formatMessage({defaultMessage:"Limit reached. This artifact uses Claude for responses. Try again when the message limit resets.",id:"5Ocu9uCFLz"}))),Error("HTTP error! status: ".concat(s.status));let l=await s.json();return Promise.resolve(l.completion)}catch(e){return Promise.reject(e)}},[null==c?void 0:c.uuid,e,o,d,t,s,u,x])}},91266:(e,t,s)=>{s.d(t,{h:()=>C});var a=s(54568),n=s(66860),l=s(61125),i=s(1761),r=s(41417),o=s(82200),d=s(29242),c=s(71473),u=s(27062),x=s(57622),m=s(38583),g=s(47211),p=s(73734),h=s(28569),f=s(87606),j=s(32987),v=s(49645),y=s(37463),b=s(7620),w=s(62971),N=s(41932),S=s(56147),M=s(29722),A=s(74211),_=s(61527),k=s(59401);let C=e=>{var t;let{project:s,hasEditPermissions:n,hideCustomInstructions:l=!1}=e,[r,d]=(0,b.useState)(!1),[c,u]=(0,b.useState)(!1),[m,g]=(0,b.useState)(!1),[p,h]=(0,b.useState)(!1),f=(0,i.mV)(),v=(0,A.G)(),y=r||c||p,N=null!==s.archived_at,S=n&&!N&&!s.is_starter_project,_=!S||y,{handleDrop:C}=U({canEditKnowledgeBase:S,setIsUploadingDoc:d,projectUuid:s.uuid});return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(o.wC,{onDrop:C,className:"relative",disabled:_,children:[_?null:(0,a.jsx)(P,{message:null==v?void 0:v.projectKnowledgeDragDropMessage}),(0,a.jsxs)("div",{className:(0,j.A)("border-0.5 border-border-300 rounded-lg py-4 transition-all duration-300 ease-out lg:rounded-xl"),children:[(0,a.jsxs)("div",{className:"mb-5 flex w-full items-center px-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("h2",{className:"text-text-200 text-sm font-medium",children:null!=(t=null==v?void 0:v.projectKnowledgeTitle)?t:(0,a.jsx)(w.A,{defaultMessage:"Project knowledge",id:"QzD1ze8R7g"})})}),S&&(0,a.jsx)(k.w,{projectUuid:s.uuid,isStarterProject:s.is_starter_project,isUploading:y,setIsUploadingDoc:d,setIsUploadingGithubSync:h,setIsUploadingDriveSync:u,setIsUploadingOutlineSync:g})]}),(0,a.jsxs)("div",{className:"mx-4 flex flex-col gap-5",children:[s.is_starter_project?(0,a.jsx)(E,{}):S&&!s.is_private&&f?(0,a.jsxs)("div",{className:"bg-bg-300 text-text-200 mb-1 flex items-center gap-3 rounded-lg py-3 pl-3.5 pr-6 text-xs",children:[(0,a.jsx)(x.m,{size:24,weight:"light",className:"shrink-0"}),(0,a.jsx)(w.A,{defaultMessage:"Project is Open. Everything added to project knowledge will be viewable by your org.",id:"6UEuUHJ2nO"})]}):null,(0,a.jsx)(D,{project:s,canEditKnowledgeBase:S,hidden:l}),(0,a.jsx)(M.b,{isEditable:S,project:s,canEditKnowledgeBase:S,isUploadingDoc:r,isUploadingDriveSync:c,isUploadingOutlineSync:m,isUploadingGithubSync:p,setIsUploadingDoc:d,setIsUploadingDriveSync:u,setIsUploadingOutlineSync:g,setIsUploadingGithubSync:h},"KnowledgeList")]})]})]})})},U=e=>{let{projectUuid:t,setIsUploadingDoc:s,canEditKnowledgeBase:a}=e,r=(0,l.cV)(),o=(0,S.ED)(t),{maxKbTokens:d}=(0,S.AO)(),{activeOrganization:x}=(0,i.YL)(),m=null==x?void 0:x.uuid,g=(0,f.useQueryClient)(),{mutateAsync:p}=(0,N.fh)(t),h=(0,b.useCallback)(async(e,s)=>{for(let t of e)await p({file_name:t.file_name,content:t.extracted_content});s.length&&g.invalidateQueries({queryKey:[c.mw,{orgUuid:m,projectUuid:t}]})},[p,m,t,g]),j=(0,n.i1)(),{value:v}=(0,u.fS)("project_janus"),{value:y}=(0,u.fS)("project_image"),{handleUpload:w}=(0,n.vV)({imagesEnabled:y,blobFileUploadsEnabled:r,rasterizePdfUploadsEnabled:j&&v,onUploadComplete:async function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return await h(...t)},onError:()=>{s(!1)},projectUuid:t});return{handleDrop:async e=>{if(!a)return;let t=Array.from(e.dataTransfer.files);t&&(s(!0),await w(Array.from(t),d-(null!=o?o:0)),s(!1))}}},D=e=>{let{project:t,canEditKnowledgeBase:s,hidden:n=!1}=e,[l,i]=(0,b.useState)(!1);if(!t.is_starter_project&&!n)return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.$,{variant:"unstyled",disabled:!s,size:"unset",className:"border-border-300 hover:border-border-200 hover:bg-bg-300/50 text-text-300 hover:text-text-100 flex w-full cursor-pointer rounded-lg border border-dashed px-3 py-2 text-left text-sm transition-colors",onClick:()=>i(!0),children:""===t.prompt_template?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.A,{defaultMessage:"Set project instructions",id:"+On7CFwfGv"}),(0,a.jsx)(d.m,{side:"bottom",className:"text-center",tooltipContent:""===t.prompt_template&&(0,a.jsx)(w.A,{defaultMessage:"Provide Claude with specific instructions and context for all chats in this project",id:"TjeUJQCeBg"}),children:(0,a.jsx)("div",{className:"p-1 hover:text-text-200 text-text-500",children:(0,a.jsx)(m.R,{size:14,className:"ml-1.5 mt-px"})})})]}),(0,a.jsx)("div",{className:"text-text-400 mt-px text-xs",children:(0,a.jsx)(w.A,{defaultMessage:"Optional",id:"InWqysQtIQ"})})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-claude-response -ml-1 mr-px h-5 text-lg leading-none before:content-[open-quote]"}),(0,a.jsx)("div",{className:"flex-1 truncate text-xs",children:t.prompt_template}),(0,a.jsx)("div",{className:"text-accent-secondary-000 ml-1.5",children:(0,a.jsx)(w.A,{defaultMessage:"Edit",id:"wEQDC6Wv3/"})})]})}),(0,a.jsx)(_.k,{isOpen:l,onClose:()=>i(!1),project:t})]})},P=e=>{let{message:t}=e,{dragState:s}=(0,o.t1)(),n=s===o.mq.DRAGGING_OFF_TARGET||s===o.mq.DRAGGING_ON_TARGET;return(0,a.jsx)(v.N,{children:n&&(0,a.jsx)(y.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:(0,j.A)("absolute inset-0 z-10 flex flex-col justify-center rounded-lg border border-dashed transition-colors",s===o.mq.DRAGGING_ON_TARGET?"bg-accent-secondary-900 border-accent-secondary-200 text-accent-secondary-000":"bg-bg-100 border-border-200 text-text-300"),children:(0,a.jsxs)("div",{className:"py-1.5 text-center",children:[(0,a.jsxs)("div",{className:"relative inline-block opacity-60",children:[(0,a.jsx)(g.i,{size:32,weight:"light",className:"absolute -ml-4 -rotate-6"}),(0,a.jsx)(p.G,{size:32,weight:"light",className:"ml-4 translate-y-px rotate-12"})]}),(0,a.jsx)("div",{className:"font-claude-response mt-1 pb-2 text-lg tracking-tight",children:t||(0,a.jsx)(w.A,{defaultMessage:"Drop files here to add to project knowledge",id:"Y0PcamE2yZ"})})]})},"knowledge-base-drop-zone-overlay")})};function E(){return(0,a.jsxs)("div",{className:"bg-accent-pro-100/5 rounded-xl p-5",children:[(0,a.jsx)(h.E,{size:24,className:"text-accent-pro-000 mb-3"}),(0,a.jsx)("h4",{className:"text-accent-pro-000 mb-3 text-sm font-medium leading-6 tracking-tight",children:(0,a.jsx)(w.A,{defaultMessage:"Add relevant context for your project",id:"eI0e97oaOk"})}),(0,a.jsx)("p",{className:"text-text-400 mb-4 text-xs tracking-tight",children:(0,a.jsx)(w.A,{defaultMessage:"Upload documents, code, and other files to the project for Claude to reference in your chats.",id:"9IMjsytzdi"})}),(0,a.jsx)("p",{className:"text-text-400 text-xs tracking-tight",children:(0,a.jsx)(w.A,{defaultMessage:"In this example project, we’ve added key files about how to use Claude.",id:"aKC2ET8OCp"})})]})}}}]);